<mxfile host="65bd71144e">
    <diagram id="aZ6EJbNiV0EWviCFpwhp" name="Page-1">
        <mxGraphModel dx="3451" dy="2199" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" background="#114B5F" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="174" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="126" target="189">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="450" y="290" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="180" style="edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="126" target="129">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-30" y="305"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="126" value="DappConnectionController" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="20" y="264" width="220" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="170" value="" style="edgeStyle=none;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="127" target="190">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="179" style="edgeStyle=none;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="127" target="129">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-30" y="470"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="127" value="ExtensionConnectionController" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="20" y="430" width="220" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="130" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="128" target="129">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="181" style="edgeStyle=none;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="128" target="138">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="182" style="edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="128" target="136">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="128" value="ConnectionService" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-270" y="360" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="132" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="129" target="127">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-30" y="470"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="133" style="edgeStyle=none;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="129" target="126">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="-30" y="305"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="178" style="edgeStyle=none;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="129" target="128">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="129" value="source" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-70" y="350" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="137" style="edgeStyle=none;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="136" target="128">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="136" value="ExtensionFrontend" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-270" y="490" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="139" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="138" target="128">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="138" value="ContentScript" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-270" y="230" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="164" style="edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="154" target="126">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="130" y="70"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="154" value="DappEventEmitters" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="495" y="39" width="290" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="161" value="" style="group" vertex="1" connectable="0" parent="1">
                    <mxGeometry x="960" y="190" width="375" height="375" as="geometry"/>
                </mxCell>
                <mxCell id="143" value="" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;rounded=0;glass=0;" vertex="1" parent="161">
                    <mxGeometry width="375" height="375" as="geometry"/>
                </mxCell>
                <mxCell id="144" value="&lt;h1&gt;Services&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;glass=0;align=center;" vertex="1" parent="161">
                    <mxGeometry x="17.5" y="12.5" width="340" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="145" value="Wallet" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="42.5" y="60.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="146" value="Network" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="152.5" y="60.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="147" value="Permissions&lt;span style=&quot;color: rgba(0 , 0 , 0 , 0) ; font-family: monospace ; font-size: 0px&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%22Network%22%20style%3D%22ellipse%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3Baspect%3Dfixed%3Brounded%3D0%3Bglass%3D0%3Balign%3Dcenter%3BfillColor%3D%236a00ff%3BstrokeColor%3D%233700CC%3BfontColor%3D%23ffffff%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22630%22%20y%3D%22660%22%20width%3D%2280%22%20height%3D%2280%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="252.5" y="60.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="148" value="Onboarding" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="42.5" y="150.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="149" value="Accounts" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="152.5" y="150.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="150" value="Balances" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="252.5" y="150.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="151" value="Storage" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="252.5" y="240.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="152" value="Transactions" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="152.5" y="240.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="153" value="Bridge" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;glass=0;align=center;fillColor=#6a00ff;strokeColor=#FFFFFF;fontColor=#ffffff;" vertex="1" parent="161">
                    <mxGeometry x="42.5" y="240.5" width="80" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="160" value="etc... many more single purpose services" style="ellipse;whiteSpace=wrap;html=1;fillColor=#6A00FF;" vertex="1" parent="161">
                    <mxGeometry x="50" y="330" width="270" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="162" style="edgeStyle=none;html=1;startArrow=none;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="143" target="154">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1220" y="100" as="sourcePoint"/>
                        <Array as="points">
                            <mxPoint x="1148" y="70"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="167" value="Events from services" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="162">
                    <mxGeometry x="-0.4471" y="1" relative="1" as="geometry">
                        <mxPoint x="3" y="29" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="168" style="edgeStyle=none;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.473;entryY=1.025;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="165" target="127">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="124" y="670"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="165" value="Extension Event Emitters" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="495" y="640" width="290" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="166" value="Events from services" style="edgeStyle=none;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="143" target="165">
                    <mxGeometry x="-0.6552" relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="1148" y="670"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="171" style="edgeStyle=none;html=1;entryX=0;entryY=0.75;entryDx=0;entryDy=0;shape=flexArrow;" edge="1" parent="1" source="169" target="143">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="169" value="Extension Request Handlers" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="520" y="416" width="240" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="175" style="edgeStyle=none;html=1;entryX=0.003;entryY=0.296;entryDx=0;entryDy=0;shape=flexArrow;entryPerimeter=0;" edge="1" parent="1" source="173" target="143">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="173" value="Dapp Request Handlers" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="520" y="249" width="240" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="176" value="&lt;h1&gt;Content Script&lt;/h1&gt;&lt;p&gt;The content script lives in an isolated environment and acts as a relayer between websites and&amp;nbsp; the background script. Each website has it's own separate connection&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="-420" y="110" width="270" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="177" value="&lt;h1&gt;Extension Frontend&lt;/h1&gt;&lt;p&gt;The extension frontend can directly connect to the background script, send requests to it and receive events&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="-420" y="550" width="270" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="183" value="&lt;h1&gt;Connection Service&lt;/h1&gt;&lt;p&gt;The connection service is responsible for handling all incoming connection requests and creating instances of the appropriate connection controller based on the connection's source.&lt;/p&gt;&lt;p&gt;Each tab and website has it's dedicated controller.&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="-630" y="330" width="360" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="184" value="&lt;h1&gt;Dapp Event Emitters&lt;br&gt;&lt;/h1&gt;&lt;div&gt;Responsible for emitting events to websites. Events can be about network, account, transaction and other state changes.&lt;br&gt;Dapp Event Emitters are &lt;b&gt;NOT singletons. Each website connection has their own emitters to prevent information leakage. &lt;/b&gt;This is very important since different websites have different permissions granted by the user.&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="500" y="-111" width="360" height="150" as="geometry"/>
                </mxCell>
                <mxCell id="185" value="&lt;h1&gt;Extension Event Emitters&lt;br&gt;&lt;/h1&gt;&lt;div&gt;Responsible for emitting events to the extension. Events can be about network, account, transaction and other state changes.&lt;br&gt;Extension Event Emitters are&lt;b&gt;&amp;nbsp;&lt;/b&gt;singletons. Contratry to websites, all extension pages have the same permission level.&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="500" y="710" width="340" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="186" value="&lt;h1&gt;Services&lt;br&gt;&lt;/h1&gt;&lt;div&gt;The extension backround script is comprized of multiple single purpose services. This limits the scope and complexity of them. They can be invoked from handlers, and other services.&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="1350" y="320" width="340" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="187" value="&lt;h1&gt;Dapp Request Handlers&lt;br&gt;&lt;/h1&gt;&lt;div&gt;They handle RPC requests coming from websites. They always have two separate execution paths for authorised and non authorized cases depending on whether the user has previously granted the website permission.&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="520" y="130" width="340" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="188" value="&lt;h1&gt;Extension Request Handlers&lt;br&gt;&lt;/h1&gt;&lt;div&gt;Handle RPC requests from extension pages.&amp;nbsp;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="520" y="530" width="340" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="193" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="189" target="173">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="189" value="Request Processor Pipeline" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1A1A1A;" vertex="1" parent="1">
                    <mxGeometry x="360" y="274" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="191" style="edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="190" target="169">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="190" value="Request Processor Pipeline" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1A1A1A;" vertex="1" parent="1">
                    <mxGeometry x="365" y="441" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="195" value="&lt;h1&gt;Request Processor Pipeline&lt;/h1&gt;&lt;div&gt;Responsible for adding metadata for the individual RPC requests. Such as Domain information, permisson handling, forwarding the call to the RPC node or to the local request handler depending on whether there is a matching handler locally.&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="170" y="130" width="340" height="130" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>